<!DOCTYPE html>
  <html>
    <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
      <title>req 2</title>
      <!-- reference the css and CDN -->
      <link rel="stylesheet" href="http://js.arcgis.com/3.9/js/esri/css/esri.css">
<script src="http://js.arcgis.com/3.9/"></script>
<script>

// load modules
var map;
   // [ ] = an array of modules available at js.arcgis.com
// function ( ) expects aliases for each module loaded, in same order as invoked in preceding array

require (["esri/map",
  "esri/dijit/Popup",
  "esri/dijit/PopupTemplate",
  "esri/layers/FeatureLayer",
        "esri/symbols/SimpleLineSymbol",
        "esri/symbols/SimpleFillSymbol",
        "esri/symbols/TextSymbol",
        "esri/symbols/SimpleMarkerSymbol",
        "esri/renderers/SimpleRenderer",
        "esri/layers/LabelLayer",
        "dojo/_base/Color",
        "dojo/dom-construct",
"dojo/domReady!"], function(
Map,
Popup, PopupTemplate,
FeatureLayer,
SimpleLineSymbol, SimpleFillSymbol, TextSymbol, SimpleMarkerSymbol,
SimpleRenderer,
         LabelLayer,
         Color,
         domConstruct
){

// define pop up as it is passed to Map constructor
var popup = Popup({
    titleInBody: false
},domConstruct.create("div"));

map = new Map("dubDiv", {

center: [-6.620, 53.332],
zoom: 11,
basemap: "national-geographic", // works
infoWindow: popup
}); // end map init

// create a renderer
// establish renderer parameters
var countyColor = new Color("#444");
var bLines = new SimpleLineSymbol("solid", countyColor, 1.5);
var countySymbol = new SimpleFillSymbol("solid", bLines, null);
var countyRenderer = new SimpleRenderer(countySymbol);
var theURL = "http://services.arcgis.com/pMnvm7HXxTmNXxGi/arcgis/rest/services/Ireland_Counties/FeatureServer/0";

var countyL = new FeatureLayer(theURL, {id: "counties"});
countyL.setRenderer(countyRenderer);
map.addLayer(countyL);

// init popup var

var ghostWindow = new PopupTemplate({
  title: "Unfinished Developments: <b>{DevName}</b>"
});

// // define pop up content
var content = "<b>Total Units Planned</b>: ${Total_All_Unit}" +
        "<br><b>Houses never built</b>: ${Status_No_Start_Hs}" +
        "<br><b>Apartments never built</b>: ${Status_No_Start_Apt}" +
        "<br><b>Unoccupied Houses</b>: ${Status_Vacant_Hs}"+
        "<br><b>Unoccupied Apartments</b>: ${Status_Vacant_Apt}";

ghostWindow.setContent(content);
/*

Total_All_Unit
Status_Vacant_Hs
Status_Vacant_Apt
Status_Near_Complete_No_Act_Hs -- to determine construction not instiagated
Status_Near_Complete_No_Act_Apt
Status_No_Start_Hs
Status_No_Start_Apt
// infrastructure element also quite interesting, roads and water waste

 */

// create another layer - default skeleton
// the ghost layer may require different renderer parameters
var ghostColor = new Color("#FF00CC");
var whiteLine = new SimpleLineSymbol("solid", new Color([255,0,204,0.1]), 1);
var ghostSymbol = new SimpleFillSymbol("solid", whiteLine, ghostColor);
var ghostRenderer = new SimpleRenderer(ghostSymbol);
var ghostUrl = "https://webservices.myplan.ie/ArcGIS/rest/services/MyPlan/UnfinishedHousingSurvey2012/MapServer/1";

var gEstates = new FeatureLayer(ghostUrl, {
    mode: FeatureLayer.MODE_ONDEMAND,
    infoTemplate: ghostWindow,
    outFields: ["*"]
    });

    // outFields: ["*"],
    // infoTemplate: ghostWindow
gEstates.setRenderer(ghostRenderer);

map.addLayer(gEstates);


}); // end require

</script>
<style>
html, body, #dubDiv {
padding: 0;
margin: 0;
height: 100%;
}
</style>
    </head>
    <body class="claro">
    <div id="dubDiv"></div>
  </body>
  </html>